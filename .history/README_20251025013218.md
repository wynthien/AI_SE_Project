# Chatbot v·ªõi Gemini AI

H∆∞·ªõng d·∫´n x√¢y d·ª±ng h·ªá th·ªëng chatbot ƒë∆°n gi·∫£n s·ª≠ d·ª•ng Google Gemini AI.

## Y√™u c·∫ßu ti√™n quy·∫øt

- Node.js (version 14 ho·∫∑c cao h∆°n)
- T√†i kho·∫£n Google AI Studio v·ªõi API key

## C√†i ƒë·∫∑t

1. Clone project n√†y.
2. Ch·∫°y l·ªánh c√†i ƒë·∫∑t dependencies:

```bash
npm install
```

3. L·∫•y API key t·ª´ [Google AI Studio](https://aistudio.google.com/app/apikey)

4. Thay th·∫ø `YOUR_API_KEY` trong file `.env` b·∫±ng API key th·ª±c t·∫ø c·ªßa b·∫°n.

## Ch·∫°y ·ª©ng d·ª•ng

```bash
npm start
```

Server s·∫Ω ch·∫°y t·∫°i `http://localhost:3000`. M·ªü tr√¨nh duy·ªát v√† v√†o URL ƒë√≥ ƒë·ªÉ s·ª≠ d·ª•ng chatbot.

## C√°ch ho·∫°t ƒë·ªông

- Server Express ch·∫°y tr√™n port 3000.
- Frontend HTML ƒë∆°n gi·∫£n v·ªõi JavaScript ƒë·ªÉ g·ª≠i v√† nh·∫≠n tin nh·∫Øn.
- Khi ng∆∞·ªùi d√πng g·ª≠i tin nh·∫Øn, n√≥ ƒë∆∞·ª£c g·ª≠i ƒë·∫øn API `/api/chat`.
- Router h∆∞·ªõng ƒë·∫øn controller ƒë·ªÉ x·ª≠ l√Ω logic g·ªçi Gemini AI v√† tr·∫£ v·ªÅ ph·∫£n h·ªìi.

## C·∫•u tr√∫c d·ª± √°n

S·ª≠ d·ª•ng m√¥ h√¨nh MVC ƒë·ªÉ t·ªï ch·ª©c code:

- `index.js`: Kh·ªüi t·∫°o server v√† s·ª≠ d·ª•ng routes.
- `controllers/chatController.js`: X·ª≠ l√Ω logic nghi·ªáp v·ª• c·ªßa chat.
- `routes/chat.js`: ƒê·ªãnh nghƒ©a routes cho chat API.
- `models/Message.js`: Schema Mongoose cho tin nh·∫Øn (placeholder cho t∆∞∆°ng lai).
- `public/index.html`: Giao di·ªán ng∆∞·ªùi d√πng ƒë∆°n gi·∫£n.
- `package.json`: C√°c dependencies v√† scripts.

## M·ªü r·ªông

- Th√™m authentication ƒë·ªÉ b·∫£o m·∫≠t.
- L∆∞u tr·ªØ l·ªãch s·ª≠ cu·ªôc tr√≤ chuy·ªán (database nh∆∞ MongoDB).
- T√≠ch h·ª£p v·ªõi Telegram, Discord, v.v.
- Th√™m x·ª≠ l√Ω l·ªói chi ti·∫øt h∆°n.

## L∆∞u √Ω an to√†n

- Kh√¥ng l∆∞u API key tr·ª±c ti·∫øp trong code. S·ª≠ d·ª•ng bi·∫øn m√¥i tr∆∞·ªùng (env) thay th·∫ø.
- Gi·ªõi h·∫°n rate limiting ƒë·ªÉ tr√°nh l·∫°m d·ª•ng API.

## Tests

Project includes Jest-based unit tests. Quick steps to run tests locally:

1. Install dependencies (if not already installed):

```powershell
npm install
```

2. Run tests once:

```powershell
npx jest --runInBand
```

3. Run tests in watch mode during development:

```powershell
npm run test:watch
```

The repository contains example tests:
- `controllers/chatController.test.js` ‚Äî controller unit tests with the external AI client mocked.
- `models/Message.test.js` ‚Äî simple model sanity test.

If you add new tests, place them next to the module (`*.test.js`) or under a `tests/` folder. Jest is already configured via `package.json` scripts.

## üß™ Advanced Testing & Mocking

Project includes professional-grade mocking libraries:

- **Sinon** - Spies, stubs, mocks, fakes
- **Nock** - HTTP request mocking
- **Supertest** - Express server testing  
- **jest-mock-extended** - Advanced Jest mocks

### Quick Start
```bash
npm test                    # Run tests
npm run test:coverage       # With coverage report
npm run test:debug          # Debug in VSCode
```

### Documentation
- **[TESTING.md](./TESTING.md)** - Complete testing guide
- **[MOCKING.md](./MOCKING.md)** - Advanced mocking patterns
- **[MOCKING-QUICK-REF.md](./MOCKING-QUICK-REF.md)** - Quick cheatsheet
- **[DOCUMENTATION-INDEX.md](./DOCUMENTATION-INDEX.md)** - Full index

**41 tests passing ‚Ä¢ 82% coverage ‚Ä¢ 20+ mocking examples**
